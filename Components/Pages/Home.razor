@page "/"
@using System.ComponentModel.DataAnnotations
@using System.Timers
@using System.Text.Json.Serialization
@implements IDisposable
@inject IJSRuntime JS
@inject HttpClient Http

<PageTitle>Heiwase Karate Szeged</PageTitle>

<style>
    :root {
        --primary-grad: linear-gradient(135deg, #000000, #3533cd);
        --secondary-grad: linear-gradient(135deg, #004aad, #cb6ce6);
        --text-dark: #222;
        --text-light: #fff;
        --radius: 20px;
        --font-body: 'Dosis', sans-serif;
        --font-heading: 'League Gothic', sans-serif;
    }

    * {
        box-sizing: border-box;
        scroll-behavior: smooth;
    }

    body {
        font-family: var(--font-body);
        margin: 0;
        color: var(--text-dark);
        overflow-x: hidden;
    }

    h1, h2, h3, h4 {
        font-family: var(--font-heading);
        text-transform: uppercase;
        letter-spacing: 2px;
    }

    .section-padding {
        padding: 80px 20px;
    }

    .text-gradient {
        background: var(--primary-grad);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    /* --- NAVIGÁCIÓ (Reszponzív) --- */
    .sticky-nav {
        position: fixed;
        top: 20px;
        right: 20px;
        background: var(--primary-grad);
        backdrop-filter: blur(10px);
        padding: 10px 25px;
        border-radius: 50px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        z-index: 1000;
        display: flex;
        align-items: center;
        gap: 20px;
        transition: all 0.3s ease;
    }

    .nav-links {
        display: flex;
        gap: 20px;
    }

    .sticky-nav a {
        text-decoration: none;
        text-transform: uppercase;
        color: #ffffff;
        font-weight: 700;
        font-size: 1.1rem;
        transition: 0.3s;
    }

        .sticky-nav a:hover {
            color: #cb6ce6;
        }

    .hamburger {
        display: none;
        cursor: pointer;
        color: white;
        font-size: 1.5rem;
    }

    /* --- HERO SZEGMENS --- */
    .hero {
        position: relative;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        text-align: center;
        overflow: hidden;
    }

    .video-bg {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: -2;
    }

    .hero-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        z-index: -1;
    }

    .hero-content h1 {
        font-size: 5rem;
        font-weight: 900;
        margin: 0;
        line-height: 1;
    }

    .hero-content p {
        font-size: 1.5rem;
        margin-top: 10px;
        font-weight: 300;
    }

    /* --- MIÉRT VÁLASSZ MINKET (Új szekció) --- */
    .why-us-section {
        background: var(--primary-grad);
        color: white;
        overflow: hidden; /* Animációhoz */
    }

    .why-us-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 40px;
        max-width: 1300px;
        margin: 0 auto;
    }

    .feature-card {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        padding: 40px 20px;
        border-radius: var(--radius);
        text-align: center;
        transition: transform 0.4s, background 0.4s;
        opacity: 0; /* Kezdetben láthatatlan az animációhoz */
        transform: translateY(30px);
    }

        .feature-card.visible {
            animation: fadeInUp 0.8s forwards;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            background: rgba(255, 255, 255, 0.2);
        }

    .feature-icon-large {
        font-size: 4rem;
        margin-bottom: 20px;
        color: white;
        text-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    @@keyframes fadeInUp {
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* --- BEMUTATKOZÁS --- */
    .about-section {
        background: url('img/team.jpg');
        background-position: center top;
        background-size: cover;
        color: white;
        position: relative;
    }

    .about-section-overlay {
        background: rgba(0, 0, 0, 0.7); /* Kicsit sötétebb, hogy olvashatóbb legyen */
        width: 100%;
    }

    .about-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 30px;
        max-width: 1200px;
        margin: 0 auto;
    }

    .info-bubble {
        background: var(--primary-grad);
        padding: 30px;
        border-radius: var(--radius);
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        border-left: 5px solid #cb6ce6;
        transition: transform 0.3s;
    }

        .info-bubble:hover {
            transform: translateY(-5px);
        }

    .stat-number {
        font-size: 3rem;
        font-weight: 800;
        color: #cb6ce6;
        display: block;
        font-family: var(--font-heading);
    }

    /* --- EDZŐK & HALL OF FAME KÁRTYÁK --- */
    .coaches-section {
        background: var(--secondary-grad);
    }

    .card-common {
        background: var(--primary-grad);
        border-radius: var(--radius);
        overflow: hidden;
        box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        text-align: center;
        border-bottom: 5px solid #3533cd;
        color: var(--text-light);
        height: 100%;
        display: flex;
        flex-direction: column;
        transition: transform 0.3s;
    }

    .card-common:hover {
        transform: translateY(-5px);
    }

    .card-img {
        width: 100%;
        height: 300px; /* Fix magasság a képeknek */
        object-fit: cover;
        background-color: #ddd;
    }

    .card-details {
        padding: 20px;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .card-name {
        font-size: 2rem;
        margin: 0;
        color: white;
    }

    .card-rank {
        color: whitesmoke;
        font-weight: 600;
        margin-bottom: 10px;
        display: block;
    }

    /* Hall of Fame Specifics */
    .hall-of-fame-section {
        background: var(--secondary-grad);
        color: white;
    }

    .slider-container {
        position: relative;
        max-width: 1300px;
        margin: 0 auto 60px auto;
    }

    .slider-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr); /* 3 elem egymás mellett */
        gap: 30px;
    }

    .slider-controls {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 20px;
    }

    .slider-btn {
        background: var(--primary-grad);
        color: white;
        border: none;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 1.2rem;
        transition: 0.3s;
        display: flex;
        align-items: center;
        justify-content: center;
    }

        .slider-btn:hover {
            transform: scale(1.1);
            background: var(--secondary-grad);
        }

    /* --- MWKSZ GALÉRIA & TÉRKÉPEK --- */
    .mwksz-section {
        background: var(--primary-grad);
        color: var(--text-light);
    }

    .features-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        max-width: 1200px;
        margin: 2rem auto;
    }

    .feature-item {
        background: rgba(255,255,255,0.1);
        backdrop-filter: blur(5px);
        padding: 20px;
        border-radius: var(--radius);
        text-align: center;
    }

    .feature-icon {
        font-size: 2.5rem;
        margin-bottom: 15px;
    }

    /* Modern Kollázs Galéria */
    .gallery-collage {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        grid-template-rows: repeat(2, 250px);
        gap: 15px;
        max-width: 1200px;
        margin: 0 auto 60px auto;
    }

    .gallery-img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: var(--radius);
        transition: transform 0.3s;
        cursor: pointer;
    }

        .gallery-img:hover {
            transform: scale(1.02);
            z-index: 2;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

    /* Különböző méretek a kollázshoz */
    .g-item-1 {
        grid-column: span 2;
        grid-row: span 2;
    }
    /* Nagy kép */
    .g-item-2 {
        grid-column: span 1;
        grid-row: span 1;
    }

    .g-item-3 {
        grid-column: span 1;
        grid-row: span 2;
    }
    /* Magas kép */
    .g-item-4 {
        grid-column: span 1;
        grid-row: span 1;
    }
 

    .timetable-section {
        background: url('img/edzes.jpg');
    }

    .timetable-section-overlay {
        background: rgba(0, 0, 0, 0.7);
    }

    /* --- SKEDULE & SOCIAL & CONTACT --- */
    .schedule-map-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        max-width: 1200px;
        margin: 0 auto;
    }

    .map-frame {
        width: 100%;
        height: 400px;
        border-radius: var(--radius);
        border: 0;
    }

    .social-grid {
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
    }

    .social-box {
        width: 300px;
        height: 400px;
        background: #eee;
        border-radius: var(--radius);
        display: flex;
        align-items: center;
        justify-content: center;
        color: #888;
    }

    .contact-form {
        max-width: 600px;
        margin: 0 auto;
        background: white;
        padding: 40px;
        border-radius: var(--radius);
        box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    }

    .form-control {
        width: 100%;
        padding: 12px;
        border: 2px solid #eee;
        border-radius: 10px;
        font-family: var(--font-body);
        margin-bottom: 15px;
    }

        .form-control:focus {
            border-color: #3533cd;
            outline: none;
        }

    .btn-submit {
        background: var(--primary-grad);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 30px;
        font-size: 1.2rem;
        cursor: pointer;
        width: 100%;
        font-weight: bold;
        transition: transform 0.2s;
    }

        .btn-submit:hover {
            transform: scale(1.02);
        }

    /* Sticky CTA */
    .sticky-cta {
        position: fixed;
        bottom: 30px;
        right: 30px;
        padding: 1rem;
        background: var(--primary-grad);
        color: white;
        width: 220px;
        height: 70px;
        gap: 1rem;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 5px 20px rgba(53, 51, 205, 0.4);
        z-index: 1000;
        cursor: pointer;
        transition: transform 0.3s;
        text-decoration: none;
    }

        .sticky-cta:hover {
            transform: rotate(5deg) scale(1.05);
        }

        .sticky-cta i {
            font-size: 2rem;
        }

    .sticky-cta-text {
        margin: 0;
        font-weight: bold;
        font-family: var(--font-body);
        font-size: 1.2rem;
    }

    footer {
        background: #111;
        color: #888;
        text-align: center;
        padding: 40px 20px;
    }

    /* --- RESPONSIVE MEDIA QUERIES --- */
    @@media (max-width: 768px) {
        /* Nav */
        .sticky-nav {
            top: 0;
            right: 0;
            width: 100%;
            border-radius: 0 0 20px 20px;
            justify-content: space-between;
            flex-wrap: wrap;
        }

        .nav-links {
            display: none;
            flex-direction: column;
            width: 100%;
            text-align: center;
            padding-bottom: 20px;
        }

            .nav-links.active {
                display: flex;
            }

        .hamburger {
            display: block;
        }
        /* Hero */
        .hero-content h1 {
            font-size: 3rem;
        }
        /* Slider responsive */
        .slider-grid {
            grid-template-columns: 1fr;
        }
        /* Mobilon 1 kártya látszik */
        /* Gallery responsive */
        .gallery-collage {
            grid-template-columns: 1fr;
            grid-template-rows: auto;
        }

        .g-item-1, .g-item-2, .g-item-3, .g-item-4 {
            grid-column: span 1;
            grid-row: span 1;
            height: 250px;
        }
        
        /* Layouts */
        .schedule-map-container {
            grid-template-columns: 1fr;
        }
        /* CTA */
        .sticky-cta {
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
        }

        .sticky-cta-text {
            display: none;
        }
    }
</style>

<section id="home" class="hero">
    <video autoplay muted loop playsinline class="video-bg">
        <source src="videos/videoplayback.mp4" type="video/mp4">
        <div style="background: black; width: 100%; height: 100%;"></div>
    </video>
    <div class="hero-overlay"></div>

    <div class="hero-content">
        <h1 style="font-family: 'Dosis', sans-serif">Heiwase Karate <span style="color: #4dabf7">Szeged</span></h1>
        <p>Eddz saját korcsoportodban! Ovistól a felnőttig. 1993 óta.</p>
        <div style="margin-top: 20px;">
            <a href="#contact" class="btn-submit" style="text-decoration:none; display:inline-block; width:auto;">Csatlakozz Hozzánk</a>
        </div>
    </div>
</section>

<nav class="sticky-nav">
    <img src="img/logo.png" width="50" alt="Logo" />

    <div class="hamburger" @onclick="ToggleMenu">
        <i class="fas fa-bars"></i>
    </div>

    <div class="nav-links @(isMenuOpen ? "active" : "")">
        <a href="#home" @onclick="CloseMenu">Kezdőlap</a>
        <a href="#why-us" @onclick="CloseMenu">Edzéstípusok</a>
        <a href="#about" @onclick="CloseMenu">Rólunk</a>
        <a href="#coaches" @onclick="CloseMenu">Edzők</a>
        <a href="#mwksz" @onclick="CloseMenu">Szövetség</a>
        <a href="#halloffame" @onclick="CloseMenu">Hall of Fame</a>
        <a href="#timetable" @onclick="CloseMenu">Edzésrend</a>
        <a href="#contact" @onclick="CloseMenu">Kapcsolat</a>
    </div>
</nav>

<section id="why-us" class="section-padding why-us-section">
    <div style="text-align: center; margin-bottom: 50px;">
        <h2 style="font-size: 3.5rem;">Edzéstípusaink</h2>
        <p style="font-size: 1.2rem;">Legyél akár teljesen kezdő, akár haladó, mi szívesen várunk. Nálunk megtalálod a helyed!</p>
    </div>

    <div class="why-us-grid" id="animated-cards">
        <div class="feature-card">
            <i class="fas fa-torii-gate feature-icon-large"></i>
            <h3>Wado-Ryu</h3>
            <p>Hagyományos stílus Okinawáról. Technikák, formagyakorlatok és fegyveres kobudo.</p>
        </div>
        <div class="feature-card" style="animation-delay: 0.2s;">
            <i class="fas fa-medal feature-icon-large"></i>
            <h3>Sportkarate</h3>
            <p>Országos és nemzetközi versenyek. Küzdelem (kumite) profi felkészítéssel.</p>
        </div>
        <div class="feature-card" style="animation-delay: 0.4s;">
            <i class="fas fa-shield-alt feature-icon-large"></i>
            <h3>Önvédelem</h3>
            <p>Hatékony technikák, hogy biztonságban érezd magad. Fizikai és mentális felkészítés.</p>
        </div>
        <div class="feature-card" style="animation-delay: 0.6s;">
            <i class="fas fa-dumbbell feature-icon-large"></i>
            <h3>Atlétika</h3>
            <p>Külön kondicionáló edzések a tökéletes erőnlétért és állóképességért.</p>
        </div>
    </div>
</section>

<section id="about" class="about-section">
    <div class="about-section-overlay section-padding">
        <div style="text-align:center; margin-bottom: 50px;">
            <h2 style="font-size: 3rem;">A Csapatról</h2>
            <p style="max-width: 900px; margin: 0 auto; font-size: 1.2rem;">
                A Heiwase Karate Szeged több mint 30 éve a szegedi sportélet meghatározó szereplője.
                Célunk nem csupán a technikai tudás átadása, hanem egy összetartó közösség építése.
            </p>
        </div>

        <div class="about-grid">
            <div class="info-bubble">
                <span class="stat-number">1993</span>
                <h3>óta HEIWASE</h3>
                <p>Több évtizedes tapasztalattal rendelkezünk. Szakértő edzők, haladó tanítványok.</p>
            </div>
            <div class="info-bubble">
                <span class="stat-number">100+</span>
                <h3>tanítvány</h3>
                <p>Szeged legnagyobb létszámú klubjaként a tradíció és a versenysport élvonalában.</p>
            </div>
            <div class="info-bubble">
                <span class="stat-number">DOJO</span>
                <h3>Belváros</h3>
                <p>Könnyen megközelíthető helyszínen, tatamival felszerelt saját termünkben várunk.</p>
            </div>
        </div>
    </div>
</section>

<section id="coaches" class="section-padding coaches-section">
    <h2 style="text-align:center; font-size: 3rem; margin-bottom: 40px; color: white;">Edzőink</h2>
    <div class="about-grid" style="justify-content: center;">
        <div class="card-common">
            <img class="card-img" src="img/zoli.jpg" alt="Stempel Zoltán" />
            <div class="card-details">
                <h3 class="card-name">Stempel Zoltán</h3>
                <span class="card-rank">4. dan, Vezetőedző</span>
                <p>A csapat alapítója. Tradicionális Wado-ryu.</p>
            </div>
        </div>
        <div class="card-common">
            <img class="card-img" src="img/bendi.jpg" alt="Tálas Bendegúz" />
            <div class="card-details">
                <h3 class="card-name">Tálas Bendegúz</h3>
                <span class="card-rank">1. dan, Edző</span>
                <p>Olimpiai sportkarate és modern edzéselmélet.</p>
            </div>
        </div>
    </div>
</section>

<section id="mwksz" class="section-padding mwksz-section">
    <div style="text-align: center; margin-bottom: 40px;">
        <h2 style="font-size: 3rem;">Szövetségünk</h2>
        <p>A Heiwase a Magyarországi Wado-ryu Karate Szövetség elkötelezett tagja</p>
    </div>

    <div class="features-grid">
        <div class="feature-item">
            <i class="fas fa-graduation-cap feature-icon"></i>
            <h4>Övvizsgák</h4>
            <p>Hivatalos, nemzetközileg elismert övvizsga lehetőségek évente kétszer.</p>
        </div>
        <div class="feature-item">
            <i class="fas fa-campground feature-icon"></i>
            <h4>Edzőtáborok</h4>
            <p>Nyári és téli edzőtáborok a Balatonnál és Mátraházán, közösségépítéssel.</p>
        </div>
        <div class="feature-item">
            <i class="fas fa-trophy feature-icon"></i>
            <h4>Versenyek</h4>
            <p>Rendszeres részvétel hazai és nemzetközi Wado és WKF versenyeken.</p>
        </div>
        <div class="feature-item">
            <i class="fas fa-globe-europe feature-icon"></i>
            <h4>Szemináriumok</h4>
            <p>Tanulási lehetőség japán és európai mesterektől itthon és külföldön.</p>
        </div>
    </div>

    <div class="gallery-collage">
        <img src="img/mwkszgrid/csoport.jpg" class="gallery-img g-item-1" />
        <img src="img/mwkszgrid/katica.jpg" class="gallery-img g-item-2" />
        <img src="img/mwkszgrid/technika.jpg" class="gallery-img g-item-3" />
        <img src="img/mwkszgrid/verseny.jpg" class="gallery-img g-item-4" />
    </div>

    <div style="justify-self: center;">
        <img src="img/esemenynaptar26.jpg" width="800" style="border-radius: 50px;"/>
    </div>
</section>

<section id="halloffame" class="section-padding hall-of-fame-section">
    @if (Competitors == null || Competitors.Count == 0)
    {
        <p style="text-align:center;">Adatok betöltése...</p>
    }
    else
    {
        <h3 style="text-align:center; font-size: 2.5rem; margin-bottom: 30px; color: white;">Kiemelkedő Versenyzők</h3>
        <div class="slider-container">
            <div class="slider-grid">
                @foreach (var member in GetVisibleItems(Competitors, competitorIndex))
                {
                    <div class="card-common">
                        <img class="card-img" src="@member.ImagePath" alt="@member.Name"
                             onerror="this.src='https://via.placeholder.com/300x300/3533cd/ffffff?text=Nincs+Kep';" />
                        <div class="card-details">
                            <h3 class="card-name">@member.Name</h3>
                            <span class="card-rank">@member.Title</span>
                            <p>@member.Description</p>
                        </div>
                    </div>
                }
            </div>
        </div>
    }

    @if (Senpais != null && Senpais.Count > 0)
    {
        <h3 style="text-align:center; font-size: 2.5rem; margin-bottom: 30px; margin-top: 60px; color: white;">Vezető tanítványaink</h3>
        <div class="slider-container">
            <div class="slider-grid">
                @foreach (var member in GetVisibleItems(Senpais, senpaiIndex))
                {
                    <div class="card-common">
                        <img class="card-img" src="@member.ImagePath" alt="@member.Name"
                             onerror="this.src='https://via.placeholder.com/300x300/cb6ce6/ffffff?text=Nincs+Kep';" />
                        <div class="card-details">
                            <h3 class="card-name">@member.Name</h3>
                            <span class="card-rank">@member.Title</span>
                        </div>
                    </div>
                }
            </div>
        </div>
    }

</section>

<section id="timetable" class="timetable-section">
    <div class="timetable-section-overlay section-padding">
    <div class="schedule-map-container">
        <div>
            <h2 style="font-size: 2.5rem; margin-bottom: 20px; color: white;">Edzésrend</h2>
            <img src="img/edzeseink.png" style="width:100%; border-radius: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);" alt="Edzésidőpontok" />
        </div>
        <div>
            <h2 style="font-size: 2.5rem; margin-bottom: 20px; color: white;">Heiwase dojo</h2>
            <iframe class="map-frame" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2758.895392576326!2d20.14728507673322!3d46.25203397109848!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47448865664d42d3%3A0x6a16641680190847!2sSzeged%2C%20F%C3%B6ldv%C3%A1ry%20u.%203%2C%206722!5e0!3m2!1shu!2shu!4v1700000000000!5m2!1shu!2shu" allowfullscreen="" loading="lazy"></iframe>
        </div>
    </div>
    </div>
</section>

<section class="section-padding" style="background: #f9f9f9; text-align: center;">
    <h2 style="font-size: 3rem; margin-bottom: 30px;">Kövess minket!</h2>
    <div class="social-grid">
        <div class="social-box" style="border: 1px solid #ddd; background: white;">
            <div>
                <i class="fab fa-facebook fa-3x" style="color: #1877f2; margin-bottom: 10px; display: block;"></i>
                <div class="fb-page" data-href="https://www.facebook.com/szegedkaratehirek/" data-tabs="timeline" data-width="500" data-height="500" data-small-header="false" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true"><blockquote cite="https://www.facebook.com/szegedkaratehirek/" class="fb-xfbml-parse-ignore"><a href="https://www.facebook.com/szegedkaratehirek/">Heiwase Karate Szeged</a></blockquote></div>
            </div>
        </div>
        <div class="social-box" style="border: 1px solid #ddd; background: white;">
            <div>
                <i class="fab fa-instagram fa-3x" style="color: #c32aa3; margin-bottom: 10px;"></i>
                <p>Instagram Feed...</p>
                <a href="https://instagram.com/szegedkarate" target="_blank">szegedkarate</a>
            </div>
        </div>
    </div>
</section>

<section id="contact" class="section-padding" style="background: var(--primary-grad);">
    <div style="text-align: center; color: white; margin-bottom: 40px;">
        <h2 style="font-size: 3rem; color: white;">Jelentkezz Edzésre!</h2>
        <p>Az első edzés ingyenes. Töltsd ki az űrlapot!</p>
    </div>

    <div class="contact-form">
        <EditForm Model="@applicant" OnValidSubmit="@HandleValidSubmit">
            <DataAnnotationsValidator />
            <div class="form-group">
                <InputText class="form-control" @bind-Value="applicant.Name" placeholder="Teljes név" />
            </div>
            <div class="form-group">
                <InputText class="form-control" @bind-Value="applicant.Email" placeholder="pelda@email.hu" />
            </div>
            <div class="form-group">
                <InputText class="form-control" @bind-Value="applicant.Phone" placeholder="+36..." />
            </div>
            <div class="form-group">
                <InputTextArea class="form-control" @bind-Value="applicant.Message" rows="4" placeholder="Pl.: 10 éves gyerek részére..." />
            </div>
            <button type="submit" class="btn-submit">
                <i class="fas fa-paper-plane"></i> Elküldés
            </button>
            @if (formSubmitted)
            {
                <div style="margin-top: 15px; color: green; font-weight: bold; text-align: center;">Köszönjük!</div>
            }
        </EditForm>

        <div style="margin-top: 30px; text-align: center; border-top: 1px solid #eee; padding-top: 20px;">
            <p>
                <strong>Heiwase Karate Szeged</strong><br>
                <i class="fas fa-envelope"></i> info@szegedkarate.hu<br>
                <i class="fas fa-phone"></i> +36 20 123 4567
            </p>
        </div>
    </div>
</section>

<footer>
    <p>© @DateTime.Now.Year Heiwase Karate Szeged. Minden jog fenntartva.</p>
    <p style="font-size: 0.8rem;">Készítette: Zimmermann Zsolt Gábor | .NET Development</p>
</footer>

<a href="#contact" class="sticky-cta" title="Jelentkezés">
    <i class="fas fa-user-plus"></i> <p class="sticky-cta-text">CSATLAKOZZ MÉG MA!</p>
</a>

<script>
    window.addEventListener('scroll', function() {
        var cards = document.querySelectorAll('.feature-card');
        var windowHeight = window.innerHeight;
        cards.forEach(function(card) {
            var position = card.getBoundingClientRect().top;
            if (position < windowHeight - 100) {
                card.classList.add('visible');
            }
        });
    });
</script>

@code {
    // --- NAV LOGIKA ---
    private bool isMenuOpen = false;
    private void ToggleMenu() => isMenuOpen = !isMenuOpen;
    private void CloseMenu() => isMenuOpen = false;

    // --- KAPCSOLAT FORM ---
    private ApplicantModel applicant = new ApplicantModel();
    private bool formSubmitted = false;
    private void HandleValidSubmit()
    {
        formSubmitted = true;
        applicant = new ApplicantModel();
    }

    public class ApplicantModel
    {
        [Required] public string Name { get; set; } = "";
        [Required][EmailAddress] public string Email { get; set; } = "";
        public string Phone { get; set; } = "";
        public string Message { get; set; } = "";
    }

    // --- HALL OF FAME LOGIKA ---
    public class HallOfFameData
    {
        [JsonPropertyName("competitors")]
        public List<Member> Competitors { get; set; } = new();

        [JsonPropertyName("senpais")]
        public List<Member> Senpais { get; set; } = new();
    }

    public class Member
    {
        public string Name { get; set; } = "";
        public string Title { get; set; } = "";
        public string Description { get; set; } = "";
        public string ImagePath { get; set; } = ""; // Új mező a kép elérési útjához
    }

    private List<Member> Competitors = new List<Member>();
    private List<Member> Senpais = new List<Member>();
    private int competitorIndex = 0;
    private int senpaiIndex = 0;

    // Timer az automatikus lapozáshoz
    private System.Timers.Timer? _timer;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            // Adatok betöltése a wwwroot/data/halloffame.json fájlból
            var data = await Http.GetFromJsonAsync<HallOfFameData>("data/halloffame.json");

            if (data != null)
            {
                Competitors = data.Competitors;
                Senpais = data.Senpais;
            }

            // Timer indítása (5000ms = 5 másodperc)
            StartTimer();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Hiba a JSON betöltésekor: {ex.Message}");
            // Itt esetleg feltölthetsz dummy adatokat, ha a JSON nem tölthető be
        }
    }

    private void StartTimer()
    {
        _timer = new System.Timers.Timer(3000);
        _timer.Elapsed += OnTimerElapsed;
        _timer.AutoReset = true;
        _timer.Enabled = true;
    }

    private void OnTimerElapsed(object? sender, ElapsedEventArgs e)
    {
        // Léptetés
        NextCompetitor();
        NextSenpai();

        // Mivel a Timer külön szálon fut, jelezni kell a Blazornak, hogy frissítse a UI-t
        InvokeAsync(StateHasChanged);
    }

    // Erőforrások felszabadítása, ha a user elnavigál
    public void Dispose()
    {
        _timer?.Dispose();
    }

    private List<Member> GetVisibleItems(List<Member> list, int index)
    {
        var result = new List<Member>();
        if (list == null || list.Count == 0) return result;

        for (int i = 0; i < 3; i++)
        {
            result.Add(list[(index + i) % list.Count]);
        }
        return result;
    }

    private void NextCompetitor()
    {
        if (Competitors.Count > 0)
            competitorIndex = (competitorIndex + 1) % Competitors.Count;
    }

    private void PrevCompetitor()
    {
        if (Competitors.Count > 0)
            competitorIndex = (competitorIndex - 1 + Competitors.Count) % Competitors.Count;
    }

    private void NextSenpai()
    {
        if (Senpais.Count > 0)
            senpaiIndex = (senpaiIndex + 1) % Senpais.Count;
    }

    private void PrevSenpai()
    {
        if (Senpais.Count > 0)
            senpaiIndex = (senpaiIndex - 1 + Senpais.Count) % Senpais.Count;
    }
}